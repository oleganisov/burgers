/////////////////////////hamburger menu
const menu_btn = document.querySelector('#menu_btn'),
  ham_menu = document.querySelector('#ham_menu'),
  ham_list = document.querySelector('#ham_list'),
  body = document.querySelector('body');
//функция добавления/удаления активного класса меню и блокировка body
  function toggleMenu(){
    menu_btn.classList.toggle('is-active');
    ham_menu.classList.toggle('is-active');
    body.classList.toggle('is-locked');
  };
//обработчик клика на кнопке меню
menu_btn.addEventListener('click', function (e) {
  e.preventDefault();
  toggleMenu();
});
//обработчик клика на ссылках меню
ham_list.addEventListener('click', function (e) {
  let el=e.target;
  if (el.tagName=='A'){
    toggleMenu();
  };
});
/////////////////////////slider
const slide_next=document.querySelector('#slide-next'),
      slide_prev=document.querySelector('#slide-prev'),
      slide_list=document.querySelector('#slide-list'),
      style=getComputedStyle(slide_list),
      step=parseInt(getComputedStyle(slide_list.firstElementChild).width,10),
      list_width=parseInt(slide_list.children.length,10)*step;

// устанавливает right; a - текущее значение right, b - шаг сдвига 
function shift_right(a,b){
  slide_list.style.right=a+b+'px';
};
// получает текущее свойство right
function current_right(){
  let cur_right=parseInt(style.right,10);
  if (!cur_right) {
    cur_right=0;
  };
  return cur_right;
};
//обработчик клика по кнопке next
slide_next.addEventListener('click',function(e){
  e.preventDefault();
  let cur_right=current_right();
  if (cur_right<list_width-step){
    shift_right(cur_right,step);
  } 
  else {
    shift_right(0,0);
}
});
//обработчик клика по кнопке prev
slide_prev.addEventListener('click',function(e){
  e.preventDefault();
  let  cur_right=current_right();
  if (cur_right>0){
    shift_right(cur_right,-step);
  }
  else {
    shift_right(list_width,-step);
  };
});
/////////////////////////accordeon team & menu
const team_accord=document.querySelector("#team_accord"),
      menu_accord=document.querySelector("#menu_accord");
// вычисление высоты
function calcHeight(item){
  let pic_h=$(item).find('.team__pic').height();
  let desc_h=$(item).find('.team__desc').height();
  return pic_h+desc_h;
};
// вычисление ширины
function calcWidth(item){
  let win_w=$(window).width();
  let link_w=$(item).find('a').width();
  let calc_w=win_w-link_w*3;
  return calc_w > 550 ? 550 : calc_w;
};
// вешаем обработчик на ul
function addLsnUl(elem_ul,item_class,expand_class){
  elem_ul.addEventListener('click',function(e){
    e.preventDefault();
    const list_item=elem_ul.querySelectorAll(item_class);

    let activeItem=document.querySelector(item_class+'.is-active');
    let curItem=e.target.closest(item_class);
    list_item.forEach(item=>{
      if (item==activeItem){
        item.classList.remove('is-active');
        if (expand_class=='.accordeon__expand'){
          $(item).find(expand_class).width('0px');
        }else{
          $(item).find(expand_class).height('0px');
        };
      };
      if (item==curItem&&item!==activeItem){
        item.classList.add('is-active');
        if (expand_class=='.accordeon__expand'){
          $(item).find(expand_class).width(calcWidth(item));
        }
        else{
          $(item).find(expand_class).height(calcHeight(item));
        };
    };
  });
  });
};

addLsnUl(team_accord,'.team__item','.team__expand');
addLsnUl(menu_accord,'.accordeon__item','.accordeon__expand');

// модуль overlay
const modal=document.querySelector('#modal');
const modal_inner=document.querySelector('#modal_inner');
const template = document.querySelector("#overlayTemplate").innerHTML;
const review_btns=document.querySelectorAll('.reviews__btn');
const overlay = createOverlay(template);
// установка прослушивателя кликов на кнопках отзывов
review_btns.forEach(rev_btn => {
  rev_btn.addEventListener('click',function(e){
  e.preventDefault();
  let rev_text=rev_btn.previousElementSibling.textContent;
  let rev_tittle=rev_btn.previousElementSibling.previousElementSibling.textContent;
  overlay.open();
  overlay.setContent(rev_tittle,rev_text);
});
});
//функция создания оверлея
function createOverlay(template) {
  let fragment = document.createElement('div');

  fragment.innerHTML = template;

  const overlayElement = fragment.querySelector(".overlay");
  const contentTittle = fragment.querySelector("#tittle_mod");
  const contentText = fragment.querySelector("#text_mod");
  const closeBtn = fragment.querySelector("#close_btn");
  
  fragment = null;
// установка прослушивателя кликов на кнопке закрытия оверлея
  closeBtn.addEventListener("click", function(e) {
    e.preventDefault();
    modal_inner.removeChild(overlayElement);
    modal.classList.remove('is-active');
    body.classList.remove('is-locked');
  });

  return {
    open() {
      modal_inner.appendChild(overlayElement);
      modal.classList.add('is-active');
      body.classList.add('is-locked');
    },
    close() {
      closeBtn.click();
    },
    setContent(tittle_mod,text_mod) {
      contentText.innerHTML = text_mod;
      contentTittle.innerHTML = tittle_mod;
    }
  };
};

/////////////////////////form data
const form_order=document.querySelector('#form_order');

  form_order.addEventListener('submit',function(e){
  e.preventDefault();
  const formData = new FormData(),
  
  xhr = new XMLHttpRequest();
  xhr.resposeType='json';
  xhr.open("POST", "https://webdev-api.loftschool.com/sendmail");
  xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");

  formData.append('name',form_order.elements.firstname.value);
  formData.append('phone',form_order.elements.phone.value);
  formData.append('comment',form_order.elements.comment.value);
  formData.append('to','my@valid.em');
  
  xhr.send(formData);
  xhr.onload  = function() {
    let jsonResponse = JSON.parse(xhr.responseText);
    
    if (xhr.status!=200){
      overlay.setContent('Ошибка','Произошла ошибка отправки данных');
    } else {
      overlay.setContent('Сообщение',jsonResponse.message);
    }
    overlay.open();
 };
});
//yandex map
ymaps.ready(init);
var placemarks=[
  {
    latitude:59.97,
    longitude:30.31,
    hintContent:'<div class="map__hint">ул. Литераторов, д.19</div>',
    balloonContent:[
      '<div class="map__balloon">ул. Литераторов, д.19</div>',
      '<div>Санкт-Петербург, Россия</div>'
    ]
  },
  {
    latitude:59.94,
    longitude:30.25,
    hintContent:'<div class="map__hint">Малый проспект В.О., д.64</div>',
    balloonContent:[
      '<div class="map__balloon">Малый проспект В.О., д.64</div>',
      '<div>Санкт-Петербург, Россия</div>'
    ]
  },
  {
    latitude:59.93,
    longitude:30.34,
    hintContent:'<div class="map__hint">наб. реки Фонтанки, д.56</div>',
    balloonContent:[
      '<div class="map__balloon">наб. реки Фонтанки, д.56</div>',
      '<div>Санкт-Петербург, Россия</div>'
    ]
  },
  {
    latitude:59.984597,
    longitude:30.368939,
    hintContent:'<div class="map__hint">проспект маршала Блюхера 6</div>',
    balloonContent:[
      '<div class="map__balloon">проспект маршала Блюхера 6</div>',
      '<div>Санкт-Петербург, Россия</div>'
    ]
  }
];
  function init(){ 
    var map = new ymaps.Map("sec_map", {
      center: [59.94, 30.32],
      zoom: 12,
      controls:['zoomControl'],
      behaviors:['drag']
    }); 
placemarks.forEach(obj =>{
  var placemark=new ymaps.Placemark([obj.latitude,obj.longitude],{
    hintContent:obj.hintContent,
    balloonContent:obj.balloonContent.join('')
  },
  {
    iconLayout:'default#image',
    iconImageHref:'../img/icons/map-marker.svg',
    iconImageSize:[46,57],
    iconImageOffset:[-23,-57]
  })
  map.geoObjects.add(placemark);
});
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2hhbWJ1cmdlciBtZW51XHJcbmNvbnN0IG1lbnVfYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21lbnVfYnRuJyksXHJcbiAgaGFtX21lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaGFtX21lbnUnKSxcclxuICBoYW1fbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNoYW1fbGlzdCcpLFxyXG4gIGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbi8v0YTRg9C90LrRhtC40Y8g0LTQvtCx0LDQstC70LXQvdC40Y8v0YPQtNCw0LvQtdC90LjRjyDQsNC60YLQuNCy0L3QvtCz0L4g0LrQu9Cw0YHRgdCwINC80LXQvdGOINC4INCx0LvQvtC60LjRgNC+0LLQutCwIGJvZHlcclxuICBmdW5jdGlvbiB0b2dnbGVNZW51KCl7XHJcbiAgICBtZW51X2J0bi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgIGhhbV9tZW51LmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgYm9keS5jbGFzc0xpc3QudG9nZ2xlKCdpcy1sb2NrZWQnKTtcclxuICB9O1xyXG4vL9C+0LHRgNCw0LHQvtGC0YfQuNC6INC60LvQuNC60LAg0L3QsCDQutC90L7Qv9C60LUg0LzQtdC90Y5cclxubWVudV9idG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICB0b2dnbGVNZW51KCk7XHJcbn0pO1xyXG4vL9C+0LHRgNCw0LHQvtGC0YfQuNC6INC60LvQuNC60LAg0L3QsCDRgdGB0YvQu9C60LDRhSDQvNC10L3RjlxyXG5oYW1fbGlzdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgbGV0IGVsPWUudGFyZ2V0O1xyXG4gIGlmIChlbC50YWdOYW1lPT0nQScpe1xyXG4gICAgdG9nZ2xlTWVudSgpO1xyXG4gIH07XHJcbn0pO1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vc2xpZGVyXHJcbmNvbnN0IHNsaWRlX25leHQ9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NsaWRlLW5leHQnKSxcclxuICAgICAgc2xpZGVfcHJldj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2xpZGUtcHJldicpLFxyXG4gICAgICBzbGlkZV9saXN0PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzbGlkZS1saXN0JyksXHJcbiAgICAgIHN0eWxlPWdldENvbXB1dGVkU3R5bGUoc2xpZGVfbGlzdCksXHJcbiAgICAgIHN0ZXA9cGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShzbGlkZV9saXN0LmZpcnN0RWxlbWVudENoaWxkKS53aWR0aCwxMCksXHJcbiAgICAgIGxpc3Rfd2lkdGg9cGFyc2VJbnQoc2xpZGVfbGlzdC5jaGlsZHJlbi5sZW5ndGgsMTApKnN0ZXA7XHJcblxyXG4vLyDRg9GB0YLQsNC90LDQstC70LjQstCw0LXRgiByaWdodDsgYSAtINGC0LXQutGD0YnQtdC1INC30L3QsNGH0LXQvdC40LUgcmlnaHQsIGIgLSDRiNCw0LMg0YHQtNCy0LjQs9CwIFxyXG5mdW5jdGlvbiBzaGlmdF9yaWdodChhLGIpe1xyXG4gIHNsaWRlX2xpc3Quc3R5bGUucmlnaHQ9YStiKydweCc7XHJcbn07XHJcbi8vINC/0L7Qu9GD0YfQsNC10YIg0YLQtdC60YPRidC10LUg0YHQstC+0LnRgdGC0LLQviByaWdodFxyXG5mdW5jdGlvbiBjdXJyZW50X3JpZ2h0KCl7XHJcbiAgbGV0IGN1cl9yaWdodD1wYXJzZUludChzdHlsZS5yaWdodCwxMCk7XHJcbiAgaWYgKCFjdXJfcmlnaHQpIHtcclxuICAgIGN1cl9yaWdodD0wO1xyXG4gIH07XHJcbiAgcmV0dXJuIGN1cl9yaWdodDtcclxufTtcclxuLy/QvtCx0YDQsNCx0L7RgtGH0LjQuiDQutC70LjQutCwINC/0L4g0LrQvdC+0L/QutC1IG5leHRcclxuc2xpZGVfbmV4dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oZSl7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGxldCBjdXJfcmlnaHQ9Y3VycmVudF9yaWdodCgpO1xyXG4gIGlmIChjdXJfcmlnaHQ8bGlzdF93aWR0aC1zdGVwKXtcclxuICAgIHNoaWZ0X3JpZ2h0KGN1cl9yaWdodCxzdGVwKTtcclxuICB9IFxyXG4gIGVsc2Uge1xyXG4gICAgc2hpZnRfcmlnaHQoMCwwKTtcclxufVxyXG59KTtcclxuLy/QvtCx0YDQsNCx0L7RgtGH0LjQuiDQutC70LjQutCwINC/0L4g0LrQvdC+0L/QutC1IHByZXZcclxuc2xpZGVfcHJldi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oZSl7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGxldCAgY3VyX3JpZ2h0PWN1cnJlbnRfcmlnaHQoKTtcclxuICBpZiAoY3VyX3JpZ2h0PjApe1xyXG4gICAgc2hpZnRfcmlnaHQoY3VyX3JpZ2h0LC1zdGVwKTtcclxuICB9XHJcbiAgZWxzZSB7XHJcbiAgICBzaGlmdF9yaWdodChsaXN0X3dpZHRoLC1zdGVwKTtcclxuICB9O1xyXG59KTtcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2FjY29yZGVvbiB0ZWFtICYgbWVudVxyXG5jb25zdCB0ZWFtX2FjY29yZD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3RlYW1fYWNjb3JkXCIpLFxyXG4gICAgICBtZW51X2FjY29yZD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21lbnVfYWNjb3JkXCIpO1xyXG4vLyDQstGL0YfQuNGB0LvQtdC90LjQtSDQstGL0YHQvtGC0YtcclxuZnVuY3Rpb24gY2FsY0hlaWdodChpdGVtKXtcclxuICBsZXQgcGljX2g9JChpdGVtKS5maW5kKCcudGVhbV9fcGljJykuaGVpZ2h0KCk7XHJcbiAgbGV0IGRlc2NfaD0kKGl0ZW0pLmZpbmQoJy50ZWFtX19kZXNjJykuaGVpZ2h0KCk7XHJcbiAgcmV0dXJuIHBpY19oK2Rlc2NfaDtcclxufTtcclxuLy8g0LLRi9GH0LjRgdC70LXQvdC40LUg0YjQuNGA0LjQvdGLXHJcbmZ1bmN0aW9uIGNhbGNXaWR0aChpdGVtKXtcclxuICBsZXQgd2luX3c9JCh3aW5kb3cpLndpZHRoKCk7XHJcbiAgbGV0IGxpbmtfdz0kKGl0ZW0pLmZpbmQoJ2EnKS53aWR0aCgpO1xyXG4gIGxldCBjYWxjX3c9d2luX3ctbGlua193KjM7XHJcbiAgcmV0dXJuIGNhbGNfdyA+IDU1MCA/IDU1MCA6IGNhbGNfdztcclxufTtcclxuLy8g0LLQtdGI0LDQtdC8INC+0LHRgNCw0LHQvtGC0YfQuNC6INC90LAgdWxcclxuZnVuY3Rpb24gYWRkTHNuVWwoZWxlbV91bCxpdGVtX2NsYXNzLGV4cGFuZF9jbGFzcyl7XHJcbiAgZWxlbV91bC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oZSl7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCBsaXN0X2l0ZW09ZWxlbV91bC5xdWVyeVNlbGVjdG9yQWxsKGl0ZW1fY2xhc3MpO1xyXG5cclxuICAgIGxldCBhY3RpdmVJdGVtPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaXRlbV9jbGFzcysnLmlzLWFjdGl2ZScpO1xyXG4gICAgbGV0IGN1ckl0ZW09ZS50YXJnZXQuY2xvc2VzdChpdGVtX2NsYXNzKTtcclxuICAgIGxpc3RfaXRlbS5mb3JFYWNoKGl0ZW09PntcclxuICAgICAgaWYgKGl0ZW09PWFjdGl2ZUl0ZW0pe1xyXG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XHJcbiAgICAgICAgaWYgKGV4cGFuZF9jbGFzcz09Jy5hY2NvcmRlb25fX2V4cGFuZCcpe1xyXG4gICAgICAgICAgJChpdGVtKS5maW5kKGV4cGFuZF9jbGFzcykud2lkdGgoJzBweCcpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgJChpdGVtKS5maW5kKGV4cGFuZF9jbGFzcykuaGVpZ2h0KCcwcHgnKTtcclxuICAgICAgICB9O1xyXG4gICAgICB9O1xyXG4gICAgICBpZiAoaXRlbT09Y3VySXRlbSYmaXRlbSE9PWFjdGl2ZUl0ZW0pe1xyXG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XHJcbiAgICAgICAgaWYgKGV4cGFuZF9jbGFzcz09Jy5hY2NvcmRlb25fX2V4cGFuZCcpe1xyXG4gICAgICAgICAgJChpdGVtKS5maW5kKGV4cGFuZF9jbGFzcykud2lkdGgoY2FsY1dpZHRoKGl0ZW0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgICQoaXRlbSkuZmluZChleHBhbmRfY2xhc3MpLmhlaWdodChjYWxjSGVpZ2h0KGl0ZW0pKTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICB9KTtcclxuICB9KTtcclxufTtcclxuXHJcbmFkZExzblVsKHRlYW1fYWNjb3JkLCcudGVhbV9faXRlbScsJy50ZWFtX19leHBhbmQnKTtcclxuYWRkTHNuVWwobWVudV9hY2NvcmQsJy5hY2NvcmRlb25fX2l0ZW0nLCcuYWNjb3JkZW9uX19leHBhbmQnKTtcclxuXHJcbi8vINC80L7QtNGD0LvRjCBvdmVybGF5XHJcbmNvbnN0IG1vZGFsPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtb2RhbCcpO1xyXG5jb25zdCBtb2RhbF9pbm5lcj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbW9kYWxfaW5uZXInKTtcclxuY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI292ZXJsYXlUZW1wbGF0ZVwiKS5pbm5lckhUTUw7XHJcbmNvbnN0IHJldmlld19idG5zPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZXZpZXdzX19idG4nKTtcclxuY29uc3Qgb3ZlcmxheSA9IGNyZWF0ZU92ZXJsYXkodGVtcGxhdGUpO1xyXG4vLyDRg9GB0YLQsNC90L7QstC60LAg0L/RgNC+0YHQu9GD0YjQuNCy0LDRgtC10LvRjyDQutC70LjQutC+0LIg0L3QsCDQutC90L7Qv9C60LDRhSDQvtGC0LfRi9Cy0L7QslxyXG5yZXZpZXdfYnRucy5mb3JFYWNoKHJldl9idG4gPT4ge1xyXG4gIHJldl9idG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKGUpe1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBsZXQgcmV2X3RleHQ9cmV2X2J0bi5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLnRleHRDb250ZW50O1xyXG4gIGxldCByZXZfdGl0dGxlPXJldl9idG4ucHJldmlvdXNFbGVtZW50U2libGluZy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLnRleHRDb250ZW50O1xyXG4gIG92ZXJsYXkub3BlbigpO1xyXG4gIG92ZXJsYXkuc2V0Q29udGVudChyZXZfdGl0dGxlLHJldl90ZXh0KTtcclxufSk7XHJcbn0pO1xyXG4vL9GE0YPQvdC60YbQuNGPINGB0L7Qt9C00LDQvdC40Y8g0L7QstC10YDQu9C10Y9cclxuZnVuY3Rpb24gY3JlYXRlT3ZlcmxheSh0ZW1wbGF0ZSkge1xyXG4gIGxldCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cclxuICBmcmFnbWVudC5pbm5lckhUTUwgPSB0ZW1wbGF0ZTtcclxuXHJcbiAgY29uc3Qgb3ZlcmxheUVsZW1lbnQgPSBmcmFnbWVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlcIik7XHJcbiAgY29uc3QgY29udGVudFRpdHRsZSA9IGZyYWdtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGl0dGxlX21vZFwiKTtcclxuICBjb25zdCBjb250ZW50VGV4dCA9IGZyYWdtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGV4dF9tb2RcIik7XHJcbiAgY29uc3QgY2xvc2VCdG4gPSBmcmFnbWVudC5xdWVyeVNlbGVjdG9yKFwiI2Nsb3NlX2J0blwiKTtcclxuICBcclxuICBmcmFnbWVudCA9IG51bGw7XHJcbi8vINGD0YHRgtCw0L3QvtCy0LrQsCDQv9GA0L7RgdC70YPRiNC40LLQsNGC0LXQu9GPINC60LvQuNC60L7QsiDQvdCwINC60L3QvtC/0LrQtSDQt9Cw0LrRgNGL0YLQuNGPINC+0LLQtdGA0LvQtdGPXHJcbiAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIG1vZGFsX2lubmVyLnJlbW92ZUNoaWxkKG92ZXJsYXlFbGVtZW50KTtcclxuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1sb2NrZWQnKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIG9wZW4oKSB7XHJcbiAgICAgIG1vZGFsX2lubmVyLmFwcGVuZENoaWxkKG92ZXJsYXlFbGVtZW50KTtcclxuICAgICAgbW9kYWwuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XHJcbiAgICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgnaXMtbG9ja2VkJyk7XHJcbiAgICB9LFxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgIGNsb3NlQnRuLmNsaWNrKCk7XHJcbiAgICB9LFxyXG4gICAgc2V0Q29udGVudCh0aXR0bGVfbW9kLHRleHRfbW9kKSB7XHJcbiAgICAgIGNvbnRlbnRUZXh0LmlubmVySFRNTCA9IHRleHRfbW9kO1xyXG4gICAgICBjb250ZW50VGl0dGxlLmlubmVySFRNTCA9IHRpdHRsZV9tb2Q7XHJcbiAgICB9XHJcbiAgfTtcclxufTtcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9mb3JtIGRhdGFcclxuY29uc3QgZm9ybV9vcmRlcj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZm9ybV9vcmRlcicpO1xyXG5cclxuICBmb3JtX29yZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsZnVuY3Rpb24oZSl7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCksXHJcbiAgXHJcbiAgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgeGhyLnJlc3Bvc2VUeXBlPSdqc29uJztcclxuICB4aHIub3BlbihcIlBPU1RcIiwgXCJodHRwczovL3dlYmRldi1hcGkubG9mdHNjaG9vbC5jb20vc2VuZG1haWxcIik7XHJcbiAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJYLVJlcXVlc3RlZC1XaXRoXCIsIFwiWE1MSHR0cFJlcXVlc3RcIik7XHJcblxyXG4gIGZvcm1EYXRhLmFwcGVuZCgnbmFtZScsZm9ybV9vcmRlci5lbGVtZW50cy5maXJzdG5hbWUudmFsdWUpO1xyXG4gIGZvcm1EYXRhLmFwcGVuZCgncGhvbmUnLGZvcm1fb3JkZXIuZWxlbWVudHMucGhvbmUudmFsdWUpO1xyXG4gIGZvcm1EYXRhLmFwcGVuZCgnY29tbWVudCcsZm9ybV9vcmRlci5lbGVtZW50cy5jb21tZW50LnZhbHVlKTtcclxuICBmb3JtRGF0YS5hcHBlbmQoJ3RvJywnbXlAdmFsaWQuZW0nKTtcclxuICBcclxuICB4aHIuc2VuZChmb3JtRGF0YSk7XHJcbiAgeGhyLm9ubG9hZCAgPSBmdW5jdGlvbigpIHtcclxuICAgIGxldCBqc29uUmVzcG9uc2UgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgXHJcbiAgICBpZiAoeGhyLnN0YXR1cyE9MjAwKXtcclxuICAgICAgb3ZlcmxheS5zZXRDb250ZW50KCfQntGI0LjQsdC60LAnLCfQn9GA0L7QuNC30L7RiNC70LAg0L7RiNC40LHQutCwINC+0YLQv9GA0LDQstC60Lgg0LTQsNC90L3Ri9GFJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBvdmVybGF5LnNldENvbnRlbnQoJ9Ch0L7QvtCx0YnQtdC90LjQtScsanNvblJlc3BvbnNlLm1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gICAgb3ZlcmxheS5vcGVuKCk7XHJcbiB9O1xyXG59KTtcclxuLy95YW5kZXggbWFwXHJcbnltYXBzLnJlYWR5KGluaXQpO1xyXG52YXIgcGxhY2VtYXJrcz1bXHJcbiAge1xyXG4gICAgbGF0aXR1ZGU6NTkuOTcsXHJcbiAgICBsb25naXR1ZGU6MzAuMzEsXHJcbiAgICBoaW50Q29udGVudDonPGRpdiBjbGFzcz1cIm1hcF9faGludFwiPtGD0LsuINCb0LjRgtC10YDQsNGC0L7RgNC+0LIsINC0LjE5PC9kaXY+JyxcclxuICAgIGJhbGxvb25Db250ZW50OltcclxuICAgICAgJzxkaXYgY2xhc3M9XCJtYXBfX2JhbGxvb25cIj7Rg9C7LiDQm9C40YLQtdGA0LDRgtC+0YDQvtCyLCDQtC4xOTwvZGl2PicsXHJcbiAgICAgICc8ZGl2PtCh0LDQvdC60YIt0J/QtdGC0LXRgNCx0YPRgNCzLCDQoNC+0YHRgdC40Y88L2Rpdj4nXHJcbiAgICBdXHJcbiAgfSxcclxuICB7XHJcbiAgICBsYXRpdHVkZTo1OS45NCxcclxuICAgIGxvbmdpdHVkZTozMC4yNSxcclxuICAgIGhpbnRDb250ZW50Oic8ZGl2IGNsYXNzPVwibWFwX19oaW50XCI+0JzQsNC70YvQuSDQv9GA0L7RgdC/0LXQutGCINCSLtCeLiwg0LQuNjQ8L2Rpdj4nLFxyXG4gICAgYmFsbG9vbkNvbnRlbnQ6W1xyXG4gICAgICAnPGRpdiBjbGFzcz1cIm1hcF9fYmFsbG9vblwiPtCc0LDQu9GL0Lkg0L/RgNC+0YHQv9C10LrRgiDQki7Qni4sINC0LjY0PC9kaXY+JyxcclxuICAgICAgJzxkaXY+0KHQsNC90LrRgi3Qn9C10YLQtdGA0LHRg9GA0LMsINCg0L7RgdGB0LjRjzwvZGl2PidcclxuICAgIF1cclxuICB9LFxyXG4gIHtcclxuICAgIGxhdGl0dWRlOjU5LjkzLFxyXG4gICAgbG9uZ2l0dWRlOjMwLjM0LFxyXG4gICAgaGludENvbnRlbnQ6JzxkaXYgY2xhc3M9XCJtYXBfX2hpbnRcIj7QvdCw0LEuINGA0LXQutC4INCk0L7QvdGC0LDQvdC60LgsINC0LjU2PC9kaXY+JyxcclxuICAgIGJhbGxvb25Db250ZW50OltcclxuICAgICAgJzxkaXYgY2xhc3M9XCJtYXBfX2JhbGxvb25cIj7QvdCw0LEuINGA0LXQutC4INCk0L7QvdGC0LDQvdC60LgsINC0LjU2PC9kaXY+JyxcclxuICAgICAgJzxkaXY+0KHQsNC90LrRgi3Qn9C10YLQtdGA0LHRg9GA0LMsINCg0L7RgdGB0LjRjzwvZGl2PidcclxuICAgIF1cclxuICB9LFxyXG4gIHtcclxuICAgIGxhdGl0dWRlOjU5Ljk4NDU5NyxcclxuICAgIGxvbmdpdHVkZTozMC4zNjg5MzksXHJcbiAgICBoaW50Q29udGVudDonPGRpdiBjbGFzcz1cIm1hcF9faGludFwiPtC/0YDQvtGB0L/QtdC60YIg0LzQsNGA0YjQsNC70LAg0JHQu9GO0YXQtdGA0LAgNjwvZGl2PicsXHJcbiAgICBiYWxsb29uQ29udGVudDpbXHJcbiAgICAgICc8ZGl2IGNsYXNzPVwibWFwX19iYWxsb29uXCI+0L/RgNC+0YHQv9C10LrRgiDQvNCw0YDRiNCw0LvQsCDQkdC70Y7RhdC10YDQsCA2PC9kaXY+JyxcclxuICAgICAgJzxkaXY+0KHQsNC90LrRgi3Qn9C10YLQtdGA0LHRg9GA0LMsINCg0L7RgdGB0LjRjzwvZGl2PidcclxuICAgIF1cclxuICB9XHJcbl07XHJcbiAgZnVuY3Rpb24gaW5pdCgpeyBcclxuICAgIHZhciBtYXAgPSBuZXcgeW1hcHMuTWFwKFwic2VjX21hcFwiLCB7XHJcbiAgICAgIGNlbnRlcjogWzU5Ljk0LCAzMC4zMl0sXHJcbiAgICAgIHpvb206IDEyLFxyXG4gICAgICBjb250cm9sczpbJ3pvb21Db250cm9sJ10sXHJcbiAgICAgIGJlaGF2aW9yczpbJ2RyYWcnXVxyXG4gICAgfSk7IFxyXG5wbGFjZW1hcmtzLmZvckVhY2gob2JqID0+e1xyXG4gIHZhciBwbGFjZW1hcms9bmV3IHltYXBzLlBsYWNlbWFyayhbb2JqLmxhdGl0dWRlLG9iai5sb25naXR1ZGVdLHtcclxuICAgIGhpbnRDb250ZW50Om9iai5oaW50Q29udGVudCxcclxuICAgIGJhbGxvb25Db250ZW50Om9iai5iYWxsb29uQ29udGVudC5qb2luKCcnKVxyXG4gIH0sXHJcbiAge1xyXG4gICAgaWNvbkxheW91dDonZGVmYXVsdCNpbWFnZScsXHJcbiAgICBpY29uSW1hZ2VIcmVmOicuLi9pbWcvaWNvbnMvbWFwLW1hcmtlci5zdmcnLFxyXG4gICAgaWNvbkltYWdlU2l6ZTpbNDYsNTddLFxyXG4gICAgaWNvbkltYWdlT2Zmc2V0OlstMjMsLTU3XVxyXG4gIH0pXHJcbiAgbWFwLmdlb09iamVjdHMuYWRkKHBsYWNlbWFyayk7XHJcbn0pO1xyXG59Il19
